<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Winner</title>
</head>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

<style>

  textarea {
    width: 100%;
    height: 100%;
  }
  
  </style>
  
<body>

  <nav class="navbar shadow p-3">
    <div class="container">
      <a class="navbar-brand fw-bold" href="#"><span class="text-primary" >Win</span><span class="text-black-50" >ner</span></a>

        <form>
          <a href='index.html' class="btn btn-outline-success fw-bold">Dashboard</a>
        </form>
      </div>
    </div>
  </nav>

  <div class="container mt-4" >
    <a href="index.html" class="btn btn-outline-primary">Laravel Basic</a>
    <a href="one.html" class="btn btn-outline-primary">CRUD One</a>
    <a href="two.html" class="btn btn-outline-primary">CRUD Two</a>
    <a href="three.html" class="btn btn-outline-primary">CRUD Three</a>
    <a href="four.html" class="btn btn-outline-primary">CRUD Four</a>
    <a href="five.html" class="btn btn-outline-primary">CRUD Five</a>
    <!-- <a href="six.html" class="btn btn-outline-primary">OOP PHP</a> -->
  </div>

<form action="/action_page.php" class=" form-control container mt-2">

  <p><label>Laravel model, controller & migrate</label></p>
  <textarea rows="5" cols="170" disabled>
  php artisan make:model Four -mcr
  ------------------------------------------OrAddManual
  php artisan make:model Four -m
  php artisan make:controller FourController -r
  </textarea>

  <p><label>Laravel Route</label></p>
  <textarea rows="5" cols="170" disabled>      
  Route::resource('four', FourController::class);
  Route::get('deletefour/{id}', [FourController::class,'destroy'])->name('deletefour');
  </textarea>

<p><label>Add To Table Four</label></p>
<textarea rows="5" cols="170" disabled>
  $table->string('name_four');
  $table->string('image_four');
  $table->foreignId('status')->constrained('ones')->cascadeOnDelete()->cascadeOnUpdate();
  $table->string('status')->default('no');
</textarea>

<p><label>Add manual DB:Seeder</label></p>
<textarea rows="9" cols="170" disabled>
  Four::create([
  'name_four'=> 'four',
  'image_four'=> 'https://cdn.pixabay.com/photo/2017/12/10/20/56/feather-3010848_960_720.jpg',
  'status'=> '1',
  'status'=> 'no',
]);
------------------------------------------ForDate
'date'=> Carbon::parse(),
</textarea>

<p><label>Laravel migrate:fresh and seed</label></p>
<textarea rows="2" cols="170" disabled>
php artisan migrate:fresh --seed
</textarea>

<p><label>Add To Model Four</label></p>
<textarea rows="8" cols="170" disabled>
  protected $guarded = ['id'];
  protected $table = 'fours'; //for relasi

  public function one() //for relasi
  {
      return $this->belongsTo(One::class); //for relasi
  }
</textarea>

<p><label>Add cRudController</label></p>
<textarea rows="3" cols="170" disabled>
  $data = Four::all();
  return view('/four/four', compact('data'));
</textarea>

<p><label>Add cRudView</label></p>
<textarea rows="34" cols="170" disabled>
  <a href="four/create" class="btn btn-outline-primary" >Add Four</a>
  <table class="table">
      <thead>
          <tr>
          <th scope="col">#</th>
          <th scope="col">Four</th>
          <th scope="col">One</th>
          <th scope="col">Image</th>
          <th scope="col">Status</th>
          <th scope="col">Action</th>
          </tr>
      </thead>
      <tbody>
          @foreach ($data as $file)
          <tr>
          <th scope="row">{{$loop->iteration}}</th>
          <td>{{$file['name_four']}}</td>
          <td>{{$file->one->name_one}}</td>
          <td><img src="{{ asset('storage/'.$file->image_four) }}" alt="" width="100px"></td>
          <!-- @if ($file->image)
          @else
          <td><img src="{{$file['image_four']}}" width="100px" alt=""></td>
          @endif -->
          <td>{{$file['status']}}</td>
          <td>
          <a href="{{url('four/'.$file->id.'/edit')}}" class="btn btn-outline-success" >Edit</a>
          |
          <a href="{{url('deletefour/'.$file->id)}}" class="btn btn-outline-danger" >Delete</a>
          </td>
          </tr>
          @endforeach
      </tbody>
  </table>
</textarea>

<p><label>Add CrudController</label></p>
<textarea rows="5" cols="170" disabled>
  FILESYSTEM_DISK //from config/filesystems.php
  FILESYSTEM_DISK=public //to .env
  ------------------------------------------OrAddManual
  php artisan storage:link
</textarea>

<p><label>Add CrudController</label></p>
<textarea rows="4" cols="170" disabled>
  $one = One::all();
  $data = Four::all();
  return view('/four/create', compact('data', 'one'));
</textarea>

<p><label>Add CrudController</label></p>
<textarea rows="10" cols="170" disabled>
  $validator = $request->validate([
  'name_four' => 'required|string',
  'image_four' => 'required|image',
  'one_id' => 'string',
  'status' => 'required|string',
]);
$validator['image_four'] = $request->file('image_four')->store('img');
Four::create($validator);
return redirect('/four')->with('success', 'success add four');
</textarea>

<p><label>Add CrudView</label></p>
<textarea rows="52" cols="170" disabled>
  <form action="{{url('four')}}" method="POST" enctype="multipart/form-data">
    @csrf
<div class="mb-3">
    <label for="" class="form-label @error('name_four') is-invalid @enderror">Add Four</label>
    <input type="text" class="form-control" name="name_four" id="name_four" placeholder="Input Four" >
    @error('name_four')
    <span class="invalid-feedback" role="alert">
        <strong>{{ $message }}</strong>
    </span>
    @enderror
</div>
<div class="mb-3">
<label for="one_id" class="form-label">Add One</label>
<select class="form-control" id="one_id" name="one_id">
    <option selected>Open this select menu</option>
    @foreach ($one as $file)
    <option value="{{$file->id}}" @selected(old('one_id')==$file->id)>{{$file->name_one}}</option>
    @endforeach
</select>
</div>
<div class="mb-3">
    <label for="image_four" class="form-label">Add Image</label>
    <img class="img-preview img-fluid mb-3 col-sm-5" >
    <input class="form-control" type="file" id="image_four" name="image_four" onchange="previewImage()">
</div>
<div class="mb-3">
<label for="status" class="form-label">Add Status</label>
<select class="form-control" id="status" name="status">
    <option selected>Open this select menu</option>
    <option value="yes">Yes</option>
    <option value="no">No</option>
</select>
</div>
<button type="submit" class="btn btn-outline-primary">Submit</button>
</form>

<script>
  function previewImage() {
      const image = document.querySelector('#image_four');
      const imgPreview = document.querySelector('.img-preview');

      imgPreview.style.display = 'block';

      const oFReader = new FileReader();
      oFReader.readAsDataURL(image.files[0]);

      oFReader.onload = function(oFREvent){
          imgPreview.src = oFREvent.target.result;
      }
  }
</script>
</textarea>

<p><label>Add crUdController</label></p>
<textarea rows="4" cols="170" disabled>
  $data = Four::findOrFail($id);
  $one = One::all();
  return view('four/edit', compact('data','one'));
</textarea>

<p><label>Add crUdController</label></p>
<textarea rows="27" cols="170" disabled>
  if(Auth::user()->role == 'admin'){
    //
  }elseif(Auth::user()->role == 'editor'){
    //
  }
  $data = Four::findOrFail($id);
        if ($request->file('image_four')) {
            $file = $request->file('image_four')->store('img');
            if ($request->image_four){
                Storage::delete($data->image_four);
            }
            $data->update([
                'name_four' => $request->name_four,
                'image_four' => $file,
                'one_id' => $request->one_id,
                'status' => $request->status,
            ]);
        } else {
            $data->update([
                'name_four' => $request->name_four,
                'image_four' => $data->image_four,
                'one_id' => $request->one_id,
                'status' => $request->status,
            ]);
        }
        return redirect('/four');
</textarea>

<p><label>Add crUdView</label></p>
<textarea rows="57" cols="170" disabled>
  <form action="{{url('four/'.$data->id)}}" method="POST" enctype="multipart/form-data">
    @csrf
    @method('PUT')
<div class="mb-3">
    <label for="" class="form-label @error('name_four') is-invalid @enderror">Add Four</label>
    <input type="text" class="form-control" name="name_four" id="name_four" placeholder="Input Four" value="{{$data->name_four}}">
    @error('name_four')
    <span class="invalid-feedback" role="alert">
        <strong>{{ $message }}</strong>
    </span>
    @enderror
</div>
<div class="mb-3">
<label for="one_id" class="form-label">Add One</label>
<select class="form-control" id="one_id" name="one_id">
    <option selected>Open this select menu</option>
    @foreach ($one as $file)
    <option value="{{$file->id}}" @selected ( $data->one_id==$file->id )>{{$file->name_one}}</option>
    @endforeach
</select>
</div>
<div class="mb-3">
    <label for="image_four" class="form-label">Add Image</label>
    @if($data->image_four)
    <img src="{{ asset('storage/'.$data->image_four) }}" alt="" class="img-preview img-fluid mb-3 col-sm-5 d-block">
    @else
    <img class="img-preview img-fluid mb-3 col-sm-5" >
    @endif
    <input class="form-control" type="file" id="image_four" name="image_four" onchange="previewImage()">
</div>
<div class="mb-3">
<label for="status" class="form-label">Add Status</label>
<select class="form-control" id="status" name="status">
    <option selected>Open this select menu</option>
    <option value="yes"  @selected($data->status=='yes')>Yes</option>
    <option value="no"  @selected($data->status=='no')>No</option>
</select>
</div>
<button type="submit" class="btn btn-outline-primary">Submit</button>
</form>

  <script>
    function previewImage() {
        const image = document.querySelector('#image_four');
        const imgPreview = document.querySelector('.img-preview');

        imgPreview.style.display = 'block';

        const oFReader = new FileReader();
        oFReader.readAsDataURL(image.files[0]);

        oFReader.onload = function(oFREvent){
            imgPreview.src = oFREvent.target.result;
        }
    }
</script>
</textarea>

<p><label>Add cruDController</label></p>
<textarea rows="7" cols="170" disabled>
  $data = Four::findOrFail($id);
  if($data->image_four){
      Storage::delete($data->image_four);
  }
  $data->delete();
  return redirect('/four')->with('error', 'success add four');
</textarea>

<a href="home.html">Add HomeController</a>

</form>

<!-- <div style="min-height: 65vh;"></div> -->

<nav class="navbar shadow-lg p-3 mt-4">
    <div class="container">
        <a href='#top' class="btn fw-bold text-black-50 btn-outline-info">Keatas</a>

        <form>
          <a href='#' class="btn btn-outline-success fw-bold"><i class="fa-brands fa-instagram"></i></a>
          <a href='#' class="btn btn-outline-success fw-bold"><i class="fa-brands fa-facebook"></i></a>
          <a href='#' class="btn btn-outline-success fw-bold"><i class="fa-brands fa-twitter"></i></a>
          <a href='#' class="btn btn-outline-success fw-bold"><i class="fa-brands fa-linkedin"></i></a>
        </form>
    </div>
</nav> 

</body>
</html>
